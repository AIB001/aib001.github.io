
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Personal academic website and research portfolio">
      
      
        <meta name="author" content="A.I.B.">
      
      
        <link rel="canonical" href="https://aib001.github.io/research/tools/NAMD_CDK7example/">
      
      
        <link rel="prev" href="../GROMACS_protocol/">
      
      
        <link rel="next" href="../NAMD_Parametering_new_residue/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>NAMD Tutorial - AIB001's Homepage</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#namd-procedure-cdk7-system-as-example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AIB001&#39;s Homepage" class="md-header__button md-logo" aria-label="AIB001's Homepage" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.36 2.64c1.64 0 3 1.36 3 3 0 1.65-1.36 3-3 3-1.65 0-3-1.35-3-3 0-.3.05-.58.14-.84-1.07-.51-2.25-.8-3.5-.8a8 8 0 0 0-8 8l.04.84-1.99.21L2 12A10 10 0 0 1 12 2c1.69 0 3.28.42 4.67 1.16.49-.33 1.07-.52 1.69-.52m0 2a1 1 0 0 0-1 1 1 1 0 0 0 1 1c.56 0 1-.45 1-1 0-.56-.44-1-1-1M5.64 15.36c1.65 0 3 1.35 3 3 0 .3-.05.58-.14.84 1.07.51 2.25.8 3.5.8a8 8 0 0 0 8-8l-.04-.84 1.99-.21L22 12a10 10 0 0 1-10 10c-1.69 0-3.28-.42-4.67-1.16-.49.33-1.07.52-1.69.52-1.64 0-3-1.36-3-3 0-1.65 1.36-3 3-3m0 2c-.56 0-1 .45-1 1 0 .56.44 1 1 1a1 1 0 0 0 1-1 1 1 0 0 0-1-1M12 8a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AIB001's Homepage
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NAMD Tutorial
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/AIB001/aib001.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    AIB001/aib001.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Academic Research

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../learning/" class="md-tabs__link">
          
  
  
    
  
  Learning

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../life/index.md" class="md-tabs__link">
          
  
  
    
  
  Life

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AIB001&#39;s Homepage" class="md-nav__button md-logo" aria-label="AIB001's Homepage" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.36 2.64c1.64 0 3 1.36 3 3 0 1.65-1.36 3-3 3-1.65 0-3-1.35-3-3 0-.3.05-.58.14-.84-1.07-.51-2.25-.8-3.5-.8a8 8 0 0 0-8 8l.04.84-1.99.21L2 12A10 10 0 0 1 12 2c1.69 0 3.28.42 4.67 1.16.49-.33 1.07-.52 1.69-.52m0 2a1 1 0 0 0-1 1 1 1 0 0 0 1 1c.56 0 1-.45 1-1 0-.56-.44-1-1-1M5.64 15.36c1.65 0 3 1.35 3 3 0 .3-.05.58-.14.84 1.07.51 2.25.8 3.5.8a8 8 0 0 0 8-8l-.04-.84 1.99-.21L22 12a10 10 0 0 1-10 10c-1.69 0-3.28-.42-4.67-1.16-.49.33-1.07.52-1.69.52-1.64 0-3-1.36-3-3 0-1.65 1.36-3 3-3m0 2c-.56 0-1 .45-1 1 0 .56.44 1 1 1a1 1 0 0 0 1-1 1 1 0 0 0-1-1M12 8a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4"/></svg>

    </a>
    AIB001's Homepage
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/AIB001/aib001.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    AIB001/aib001.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Academic Research
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Academic Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Small Molecules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Small Molecules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../small-molecules/LigTraj_Software_Database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LigTraj
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../small-molecules/CDK7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CDK7 Inhibitor Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Condensates
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Condensates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../condensates/FUS_PLD_Droplet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Droplet Formation Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Other Research
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Other Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/collaborative.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    THZ1 Nano Drug Delivery
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools and Tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Tools and Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GROMACS_protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GROMACS Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    NAMD Tutorial
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    NAMD Tutorial
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stsetm-description" class="md-nav__link">
    <span class="md-ellipsis">
      Stsetm description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeling-with-vmd" class="md-nav__link">
    <span class="md-ellipsis">
      Modeling with VMD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modeling with VMD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-pbd-file" class="md-nav__link">
    <span class="md-ellipsis">
      Download PBD file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#divide-the-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Divide the chain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-small-molecula-force-field" class="md-nav__link">
    <span class="md-ellipsis">
      Generate Small Molecula Force Field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-vmd-to-generate-psf-file" class="md-nav__link">
    <span class="md-ellipsis">
      Use VMD to generate PSF file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually-patch-bond-occurs-in-phosphorylation" class="md-nav__link">
    <span class="md-ellipsis">
      Manually patch bond occurs in phosphorylation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-namd3-in-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Run NAMD3 in Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run NAMD3 in Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#profileconf" class="md-nav__link">
    <span class="md-ellipsis">
      Profile(.conf)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-for-submitting-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Script for submitting tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#some-normal-error" class="md-nav__link">
    <span class="md-ellipsis">
      Some Normal Error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zju-iqb-28-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      ZJU-iqb-28 cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#result-visualization-and-rmsd-caculation" class="md-nav__link">
    <span class="md-ellipsis">
      Result Visualization and RMSD Caculation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result Visualization and RMSD Caculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pymol-visulization" class="md-nav__link">
    <span class="md-ellipsis">
      Pymol Visulization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmsd-caculation" class="md-nav__link">
    <span class="md-ellipsis">
      RMSD caculation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References:
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NAMD_Parametering_new_residue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NAMD Parametering new residue
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publications
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../learning/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Learning
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Biology
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Biology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/biology/neuron_science1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuron Science1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/biology/neuron_science2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuron Science2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/biology/ecology1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ecology1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/biology/ecology2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ecology2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Physics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Physics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/physics/Computational_Physics_forZJU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computational Physics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/physics/Equilibrium_Statistical_Physics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Equilibrium Statistical Physics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/physics/solid-state.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solid State Physics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Computational Biophysics & Others
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Computational Biophysics & Others
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../learning/others/Principle_of_FEP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Free Energy Pertubation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Life
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../life/index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    None
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../life/blog.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../life/travel.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Travel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../life/reading.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reading
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<p><font face='Times'></p>
<h1 id="namd-procedure-cdk7-system-as-example">NAMD Procedure-CDK7 System as Example<a class="headerlink" href="#namd-procedure-cdk7-system-as-example" title="Permanent link">&para;</a></h1>
<h2 id="stsetm-description">Stsetm description<a class="headerlink" href="#stsetm-description" title="Permanent link">&para;</a></h2>
<p>Cyclin-dependent kinase 7 (CDK7), along with cyclin H and MAT1, comprises the CDK-activating kinase (CAK)[1] CAK plays role in both phosphorylate C-terminal of some member in CDK-family such as CDK-1,2,3,4 and generate transcription as a compnent of TFâ…¡H(transalation factor).Also CAK phosphorylate.
As reported in past aticles,there are few phosphorylation site in CAK complex:
+ Ser164  in CDK7:  to promote the combination of CDK7 and Cyclin H
+ Ther170 in CDK7:  which is phosphorylated by PKC <span class="arithmatex">\(\iota\)</span>(downstream messeager of PI3K),this phosphorytion incerease the substract specifity
+ THR315 and Ser 304 in CyclinH,which have small impact to the system when running MD
THZ1 is a covalent represser of CAK complex,which block the pocket so that CAK unable to perform phosphorylation function. And the cell cycle may stop in G2/M check point </p>
<h2 id="modeling-with-vmd">Modeling with VMD<a class="headerlink" href="#modeling-with-vmd" title="Permanent link">&para;</a></h2>
<h3 id="download-pbd-file">Download PBD file<a class="headerlink" href="#download-pbd-file" title="Permanent link">&para;</a></h3>
<p>First download pdb file form https://www.rcsb.org/  with pdbID:6XD3.6XD3 includes three piptide CDK7,CyclinH,MAT1 along with the small molecular ligand THZ1.</p>
<h3 id="divide-the-chain">Divide the chain<a class="headerlink" href="#divide-the-chain" title="Permanent link">&para;</a></h3>
<p>First we need to select the ligand THZ1 than extract the object and save to pdb file or sdf file.Then we need to divide the chain to three part manually in <em>Pymol</em>, use command to divide the portein into chains:
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>split_chains
</span></code></pre></div>
After that export each chain and save to three pdb files:CDK7.pdb CycH.pdb and MAT1.pdb. Put three pbd file to the first fold named 'system_build'
Now, we have the baisc files we need to bulid the system</p>
<h3 id="generate-small-molecula-force-field">Generate Small Molecula Force Field<a class="headerlink" href="#generate-small-molecula-force-field" title="Permanent link">&para;</a></h3>
<p>In this setp, we use <a href="https://www.charmm-gui.org/">CHARMM-GUI</a> to generate small molecular's force field. Login in CHARMM-GUI with e-mail,and enter ' <em>Ligand Reader &amp; Modeler</em>' ,upload local file THZ1.pdb or THZ1.sdf,and press 'Upload MOL/MOL2/SDF'. The 2D ligand will be exported to the frame, an dthe 3D messege will be retained meanwhile.
Then we need to check and add protonation manually, particularly note atom like Nitrogen. After finish this setp,we can press'Next Step Search ligand' to generate foece field. CHARMM-GUI will search in the existing FF data to splicing and assembly the file. Finally download the result zip file which include lig.rtf, lig.prm etc.</p>
<h3 id="use-vmd-to-generate-psf-file">Use VMD to generate PSF file<a class="headerlink" href="#use-vmd-to-generate-psf-file" title="Permanent link">&para;</a></h3>
<p>In this step, we need to use <em>VMD</em> command and <em>psfgen</em> to generate the psf file. <em>VMD</em> support Tcl language to run scripts. In this case, we need to assemble three piptide and THZ1 ligand together. Following scripts can meet this requirments:</p>
<h4 id="revalent-topology-file">Revalent Topology File<a class="headerlink" href="#revalent-topology-file" title="Permanent link">&para;</a></h4>
<p>Firstly, import topology file we need and import <em>psfgen</em>.File <em>top_all36_prot.rtf</em> contains chemical bonding information.Topology file <em>par_all36m_prot.prm</em> contains parameters to model the protein like Amina Acids FF etc. And file <em>toppar_all36_prot_na_combined.str</em> contains FF information which we will use in following phosphorylation operation.Follows are the script:
<div class="language-Tcl highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c"># File: bpti_example.tcl</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c"># Requirements: topology file top_all22_prot.inp in directory toppar</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c"># PDB file 6PTI.pdb in current directory</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c"># Create working directory; remove old output files</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nb">package</span><span class="w"> </span>require<span class="w"> </span>psfgen
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c"># Read topology file</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="nv">topology</span><span class="w"> </span>top_all36_prot.rtf
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="nv">topology</span><span class="w"> </span>toppar_all36_prot_na_combined.str
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="nv">topology</span><span class="w"> </span>par_all36_na.prm
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="nv">topology</span><span class="w"> </span>par_all36m_prot.prm
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="nv">topology</span><span class="w"> </span>top_all36_na.rtf
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="nv">topology</span><span class="w"> </span>toppar_all36_prot_fluoro_alkanes.str
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="nv">topology</span><span class="w"> </span>top_all36_cgenff.rtf
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="nv">topology</span><span class="w"> </span>thz1.rtf
</span></code></pre></div></p>
<h4 id="rename-the-residues">Rename The Residues<a class="headerlink" href="#rename-the-residues" title="Permanent link">&para;</a></h4>
<p>To ensure the resigue name in pdb file and topology file consistent, we should change residue name.
<div class="language-Tcl highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">#rename the residues</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nv">pdbalias</span><span class="w"> </span>residue<span class="w"> </span>HIS<span class="w"> </span>HSE
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nv">pdbalias</span><span class="w"> </span>atom<span class="w"> </span>ILE<span class="w"> </span>CD1<span class="w"> </span>CD
</span></code></pre></div></p>
<h4 id="create-segment-to-assemble-the-system">Create Segment to assemble the system<a class="headerlink" href="#create-segment-to-assemble-the-system" title="Permanent link">&para;</a></h4>
<p>Command <code>segment</code> is used to create a set, in <em>psfgen User's Guide</em> discribes as follows:
+ segment [segids] [resids] [residue] [first] [last] \<segment ID> [resid] [atom name] { \<commands>}
  + Purpose: Build a segment of the molecule. A segment is typically a single chain of protein or DNA,with default patches applied to the termini. Segments may also contain pure solvent or lipid. Options[segids] [resids] [residue] [first] [last] are used to query information about the specified segment.</p>
<p>Command First and Last discribes as follows:
+ first \<patch name>
  + Purpose: Override default patch applied to first residue in segment. Default is read from topology file and may be residue-specific.
  + Arguments: <patch name>: Single-target patch residue name or none.
  + Context: Anywhere within segment, does not affect later segments.
+ last \<patch name>
  + Purpose: Override default patch applied to last residue in segment. Default is read from topology
    file and may be residue-specific.
  + Arguments: <patch name>: Single-target patch residue name or none.
  + Context: Anywhere within segment, does not affect later segments.
script as follows:
<div class="language-Tcl highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c"># Build protein segment</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nv">segment</span><span class="w"> </span>THZ1<span class="w"> </span><span class="k">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>ligandrm.pdb
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">}</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nv">segment</span><span class="w">  </span>CDK7<span class="w"> </span><span class="k">{</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>CDK7.pdb
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="nv">first</span><span class="w"> </span>ACE<span class="w"> </span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span>last<span class="w"> </span>CT3
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="k">}</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="nv">segment</span><span class="w"> </span>MAT1<span class="w"> </span><span class="k">{</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>MAT1.pdb
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">    </span><span class="nv">first</span><span class="w"> </span>ACE
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span><span class="nv">last</span><span class="w"> </span>CT3
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="k">}</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="nv">segment</span><span class="w"> </span>CycH<span class="w"> </span><span class="k">{</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>CycH.pdb<span class="w">    </span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">    </span>first<span class="w"> </span>ACE
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">    </span><span class="nv">last</span><span class="w"> </span>CT3
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="k">}</span>
</span></code></pre></div></p>
<h4 id="apply-phosphorylation-with-patch">Apply phosphorylation with <em>patch</em><a class="headerlink" href="#apply-phosphorylation-with-patch" title="Permanent link">&para;</a></h4>
<p>In <em>psfgen</em> we can use <code>patch</code> or <code>mutate</code> command to modify residues etc. In <em>psfgen User's Guide</em> discribes as follows:
+ patch [list] \<patch residue name> \<segid:resid> [...]
    + Purpose: Apply a patch to one or more residues. Patches make small modifications to the structure
    of residues such as converting one to a terminus, changing the protonation state, or creating disulphide bonds between a pair of residues.
    + Arguments: list: Lists all patches applied explicitey using the command â€™patchâ€™.
    + listall: Lists all currently applied patches including default patches.
    \<patch residue name>: Name of patch residue from topology definition file.
    \<segid:resid>: List of segment and residue pairs to which patch should be applied.
    + Context: After one or more segments have been built.
+ mutate \<resid> \<resname>
  + Purpose: Change the type of a single residue in the current segment.
  + Arguments: \<resid>: Unique name for residue, 1â€“5 characters, usually numeric. \<resname>: New</p>
<p>In this case, to judge whether use <code>mutate</code> or <code>patch</code>,we can open topology file  <em>toppar_all36_prot_na_combined.str</em> , if labled<code>RESI</code>,we should use command <code>mutate</code>;if label<code>PRES</code>
,we use command<code>patch</code>,code as follows:
<div class="language-Tcl highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">segment</span><span class="w">  </span>CDK7<span class="w"> </span><span class="k">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>CDK7.pdb
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="nv">first</span><span class="w"> </span>ACE<span class="w"> </span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span>last<span class="w"> </span>CT3
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="c"># mutate 164 SEP</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">}</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="nv">patch</span><span class="w"> </span>THPB<span class="w"> </span>CDK7:170
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="nv">patch</span><span class="w"> </span>SP2<span class="w"> </span>CDK7:164
</span></code></pre></div></p>
<h4 id="subswquent-operation">Subswquent Operation<a class="headerlink" href="#subswquent-operation" title="Permanent link">&para;</a></h4>
<p>After the model be established, few operation like import coordination,add water,add ion etc. should be down, code as follows:
<div class="language-Tcl highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nv">writepdb</span><span class="w"> </span>complex.pdb
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nv">writepsf</span><span class="w"> </span>complex.psf
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="nb">package</span><span class="w"> </span>require<span class="w"> </span>solvate
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="nb">package</span><span class="w"> </span>require<span class="w"> </span>autoionize
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c"># ionize complex</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nv">mol</span><span class="w"> </span>delete<span class="w"> </span>all
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="nv">mol</span><span class="w"> </span>load<span class="w"> </span>psf<span class="w"> </span>complex.psf<span class="w"> </span>pdb<span class="w"> </span>complex.pdb
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="nv">solvate</span><span class="w"> </span>complex.psf<span class="w"> </span>complex.pdb<span class="w"> </span><span class="o">-</span>t<span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">-</span>o<span class="w"> </span>solvated_complex
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="nv">mol</span><span class="w"> </span>delete<span class="w"> </span>all
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="nv">autoionize</span><span class="w"> </span><span class="o">-</span>psf<span class="w"> </span>solvated_complex.psf<span class="w"> </span><span class="o">-</span>pdb<span class="w"> </span>solvated_complex.pdb<span class="w"> </span><span class="o">-</span>sc<span class="w"> </span><span class="mf">0.15</span><span class="w"> </span><span class="o">-</span>o<span class="w"> </span>system
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>solvated_complex.pdb<span class="w"> </span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>file<span class="w"> </span>delete<span class="w"> </span>solvated_complex.psf
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>solvated_complex.log
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>complex.pdb
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>complex.psf
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="nv">mv</span><span class="w"> </span>system.pdb<span class="w"> </span>..<span class="o">/</span>common
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="nv">mv</span><span class="w"> </span>system.psf<span class="w"> </span>..<span class="o">/</span>common
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="nb">cd</span><span class="w"> </span>..<span class="o">/</span>common
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="c">#vmd -dispdev text -e measure.tcl -args system</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="c">#vmd -dispdev text -e fix_backbone_restrain_ca_with_ligand.tcl</span>
</span></code></pre></div></p>
<h4 id="complete-script">Complete Script<a class="headerlink" href="#complete-script" title="Permanent link">&para;</a></h4>
<div class="language-Tcl highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c"># File: bpti_example.tcl</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c"># Requirements: topology file top_all22_prot.inp in directory toppar</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c"># PDB file 6PTI.pdb in current directory</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c"># Create working directory; remove old output files</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="nb">package</span><span class="w"> </span>require<span class="w"> </span>psfgen
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c"># Read topology file</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="nv">topology</span><span class="w"> </span>top_all36_prot.rtf
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="nv">topology</span><span class="w"> </span>toppar_all36_prot_na_combined.str
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="nv">topology</span><span class="w"> </span>par_all36_na.prm
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="nv">topology</span><span class="w"> </span>par_all36m_prot.prm
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="nv">topology</span><span class="w"> </span>top_all36_na.rtf
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="nv">topology</span><span class="w"> </span>toppar_all36_prot_fluoro_alkanes.str
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="nv">topology</span><span class="w"> </span>top_all36_cgenff.rtf
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="nv">topology</span><span class="w"> </span>thz1.rtf
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="c">#rename the residues</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="nv">pdbalias</span><span class="w"> </span>residue<span class="w"> </span>HIS<span class="w"> </span>HSE
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="nv">pdbalias</span><span class="w"> </span>atom<span class="w"> </span>ILE<span class="w"> </span>CD1<span class="w"> </span>CD
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="c"># Build protein segment</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="nv">segment</span><span class="w"> </span>THZ1<span class="w"> </span><span class="k">{</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>ligandrm.pdb
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="k">}</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="nv">segment</span><span class="w">  </span>CDK7<span class="w"> </span><span class="k">{</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>CDK7.pdb
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w">    </span><span class="nv">first</span><span class="w"> </span>ACE<span class="w"> </span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="w">    </span>last<span class="w"> </span>CT3
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="w">    </span><span class="c"># mutate 164 SEP</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="k">}</span>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="c">#patch THPB CDK7:170</span>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="c">#patch SP2 CDK7:164</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="nv">segment</span><span class="w"> </span>MAT1<span class="w"> </span><span class="k">{</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>MAT1.pdb
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="w">    </span><span class="nv">first</span><span class="w"> </span>ACE
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="w">    </span><span class="nv">last</span><span class="w"> </span>CT3
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="k">}</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="nv">segment</span><span class="w"> </span>CycH<span class="w"> </span><span class="k">{</span>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a><span class="w">    </span><span class="nv">pdb</span><span class="w"> </span>CycH.pdb<span class="w">    </span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a><span class="w">    </span>first<span class="w"> </span>ACE
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a><span class="w">    </span><span class="nv">last</span><span class="w"> </span>CT3
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a><span class="k">}</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a><span class="c">#check coordinates</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a><span class="nv">coordpdb</span><span class="w"> </span>ligandrm.pdb<span class="w"> </span>THZ1
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a><span class="nv">coordpdb</span><span class="w"> </span>CDK7.pdb<span class="w"> </span>CDK7
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a><span class="nv">coordpdb</span><span class="w"> </span>MAT1.pdb<span class="w"> </span>MAT1
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a><span class="nv">coordpdb</span><span class="w"> </span>CycH.pdb<span class="w"> </span>CycH
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a><span class="c">#Phosphorylation patch</span>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a><span class="c"># Guess missing coordinates</span>
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a><span class="nv">guesscoord</span>
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a><span class="nv">writepdb</span><span class="w"> </span>complex.pdb
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a><span class="nv">writepsf</span><span class="w"> </span>complex.psf
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a>
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a><span class="nb">package</span><span class="w"> </span>require<span class="w"> </span>solvate
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a><span class="nb">package</span><span class="w"> </span>require<span class="w"> </span>autoionize
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a><span class="c"># ionize complex</span>
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a><span class="nv">mol</span><span class="w"> </span>delete<span class="w"> </span>all
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a><span class="nv">mol</span><span class="w"> </span>load<span class="w"> </span>psf<span class="w"> </span>complex.psf<span class="w"> </span>pdb<span class="w"> </span>complex.pdb
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a><span class="nv">solvate</span><span class="w"> </span>complex.psf<span class="w"> </span>complex.pdb<span class="w"> </span><span class="o">-</span>t<span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">-</span>o<span class="w"> </span>solvated_complex
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a><span class="nv">mol</span><span class="w"> </span>delete<span class="w"> </span>all
</span><span id="__span-6-71"><a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a><span class="nv">autoionize</span><span class="w"> </span><span class="o">-</span>psf<span class="w"> </span>solvated_complex.psf<span class="w"> </span><span class="o">-</span>pdb<span class="w"> </span>solvated_complex.pdb<span class="w"> </span><span class="o">-</span>sc<span class="w"> </span><span class="mf">0.15</span><span class="w"> </span><span class="o">-</span>o<span class="w"> </span>system
</span><span id="__span-6-72"><a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a>
</span><span id="__span-6-73"><a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>solvated_complex.pdb<span class="w"> </span>
</span><span id="__span-6-74"><a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a>file<span class="w"> </span>delete<span class="w"> </span>solvated_complex.psf
</span><span id="__span-6-75"><a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>solvated_complex.log
</span><span id="__span-6-76"><a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>complex.pdb
</span><span id="__span-6-77"><a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a><span class="nb">file</span><span class="w"> </span>delete<span class="w"> </span>complex.psf
</span><span id="__span-6-78"><a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a>
</span><span id="__span-6-79"><a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a><span class="nv">mv</span><span class="w"> </span>system.pdb<span class="w"> </span>..<span class="o">/</span>common
</span><span id="__span-6-80"><a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a><span class="nv">mv</span><span class="w"> </span>system.psf<span class="w"> </span>..<span class="o">/</span>common
</span><span id="__span-6-81"><a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a>
</span><span id="__span-6-82"><a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a><span class="nb">cd</span><span class="w"> </span>..<span class="o">/</span>common
</span><span id="__span-6-83"><a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a><span class="c">#vmd -dispdev text -e measure.tcl -args system</span>
</span><span id="__span-6-84"><a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a><span class="c">#vmd -dispdev text -e fix_backbone_restrain_ca_with_ligand.tcl</span>
</span><span id="__span-6-85"><a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a>
</span><span id="__span-6-86"><a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a><span class="nb">exit</span>
</span></code></pre></div>
<h3 id="manually-patch-bond-occurs-in-phosphorylation">Manually patch bond occurs in phosphorylation<a class="headerlink" href="#manually-patch-bond-occurs-in-phosphorylation" title="Permanent link">&para;</a></h3>
<p>Once we apply phosphorylation like <code>patch SP2 CDK7:164</code> to the system, there may be new bonds that occues in pdb or psf files(like -OH related 'C-O'bonds). For instance, in this example we meet this ERROR twice,one in Ser164,one in Thr170 
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>FATAL<span class="w"> </span>ERROR:<span class="w"> </span>UNABLE<span class="w"> </span>TO<span class="w"> </span>FIND<span class="w"> </span>BOND<span class="w"> </span>PARAMETERS<span class="w"> </span>FOR<span class="w"> </span>CT1<span class="w"> </span>ON2<span class="w"> </span><span class="o">(</span>ATOMS<span class="w"> </span><span class="m">2628</span><span class="w"> </span><span class="m">2626</span><span class="o">)</span>
</span></code></pre></div>
To patch this paarameter, we should add corresponding parameters to the .prm file.
Firstly, we should open .pdb file and check which kind of AA this bond belong to.
SeconDly, we open .rtf file and find corresponding AA, and further find the corresponding atom type and bond.In CDK7 case, related AA is Thr, in <em>par_all36m_prot.rtf</em> we can see:
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>RESI THR          0.00
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>GROUP   
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>ATOM N    NH1    -0.47  !     |  
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>ATOM HN   H       0.31  !  HN-N  
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>ATOM CA   CT1     0.07  !     |     OG1--HG1
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>ATOM HA   HB1     0.09  !     |    /
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>GROUP                   !  HA-CA--CB-HB  
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>ATOM CB   CT1     0.14  !     |    \     
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>ATOM HB   HA1     0.09  !     |     CG2--HG21
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>ATOM OG1  OH1    -0.66  !   O=C    / \    
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>ATOM HG1  H       0.43  !     | HG21 HG22 
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>GROUP                 
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>ATOM CG2  CT3    -0.27
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>ATOM HG21 HA3     0.09
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>ATOM HG22 HA3     0.09
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>ATOM HG23 HA3     0.09
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>GROUP   
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>ATOM C    C       0.51
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>ATOM O    O      -0.51
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>..
</span></code></pre></div>
Follow the ERROR we can find out CT1 ON2 (ATOMS 2628 2626) corresponding for CT1 and OH1. After comfirm the atom type, we can open a new terminal and enter the dictory <em>common/toppar</em>, use follow command to mate corresponding bond parameters:
<div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>grep<span class="w"> </span>-a<span class="w"> </span>CT1<span class="w"> </span>par_all36m_prot.prm<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>OH1
</span></code></pre></div>
We get related paramters:
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>OH1  CT1   428.000     1.4200 ! ALLOW   ALI ALC ARO
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>CT1  CD   OH1   55.000    110.50              ! From ASPP CT2-CD-OH1
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>CT1  CD   ON2   55.000    110.50              ! From ASPP CT2-CD-OH1
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>H    OH1  CT1    57.500   106.0000 ! ALLOW   ALC ARO ALI
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>OH1  CT1  CT1    75.700   110.1000 ! ALLOW   ALI ALC ARO
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>OH1  CT1  CT3    75.700   110.1000 ! ALLOW   ALI ALC ARO
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>OH1  CT1  HA1    45.900   108.8900 ! ALLOW   ALI ALC ARO
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>OH1  CT2  CT1    75.700   110.1000 ! ALLOW   ALI ALC ARO
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>...
</span></code></pre></div>
Then,open <em>par_all36m_prot.prm</em>, search parameter<code>OH1  CT1   428.000     1.4200 ! ALLOW   ALI ALC ARO</code>,we can locate where the parameter belong.Finally, we copy this line and rename atom type to which ERROR hints,like<code>ON2  CT1   428.000     1.4200 ! ALLOW   ALI ALC ARO</code>. 
Revise all type off parameters and submit the task to cluster again.</p>
<h2 id="run-namd3-in-cluster">Run NAMD3 in Cluster<a class="headerlink" href="#run-namd3-in-cluster" title="Permanent link">&para;</a></h2>
<h3 id="profileconf">Profile(.conf)<a class="headerlink" href="#profileconf" title="Permanent link">&para;</a></h3>
<h4 id="equliization">Equliization<a class="headerlink" href="#equliization" title="Permanent link">&para;</a></h4>
<p>There are three steps to run equlization:First run Energy Minization(pro-lig-min) ,then run Pressure qeulization(pro-lig-preequli),finally run Equlization(pro-lig-equli). The main concern to set three step is to equilize the sysytm gradually, in other words, we first use the NPT ensemble and then use the NVT ensemble.</p>
<h4 id="prodconf">Prod.conf<a class="headerlink" href="#prodconf" title="Permanent link">&para;</a></h4>
<p>Run MD and output the .log file and the .dcd file. </p>
<h3 id="script-for-submitting-tasks">Script for submitting tasks<a class="headerlink" href="#script-for-submitting-tasks" title="Permanent link">&para;</a></h3>
<p>In ZJU-iqb 28 cluster, we use <em>slurm</em> to submit tasks. </p>
<h3 id="some-normal-error">Some Normal Error<a class="headerlink" href="#some-normal-error" title="Permanent link">&para;</a></h3>
<ul>
<li>ERROR:Atoms moving too fast at timestep 16: simulation has become unstable (2 atoms on pe 0)<ul>
<li>Cause:    Some atom's velocity exceed the limtitation</li>
<li>Solution: Open the config file pro-lig-preequil and find the following fragment:
<div class="language-shell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># RESPA PROPAGATOR</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c1"># timestep                1.0</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>timestep<span class="w">                  </span><span class="m">0</span>.5
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>useSettle<span class="w">                 </span>on
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>fullElectFrequency<span class="w">        </span><span class="m">2</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>nonbondedFreq<span class="w">             </span><span class="m">1</span>
</span></code></pre></div>
Reduce <em>timestep</em> to a proper amount(like change from 2 to 0.5)</li>
</ul>
</li>
<li>ERROR: CUDA CURAND error curandGenerateNormal(genï¼Œgaussrand_xï¼Œnï¼Œ0ï¼Œ1) in file src/SequencerCUDAKernel.cuï¼ŒfunctionlangevinVelocitiesBBK2, line 4263<ul>
<li>Solution: Check whether all name in config file and fix_backbone_restrain_ca_with_ligand.tcl script mathched. One another possibility is the parameters in config file need to be corrected.</li>
</ul>
</li>
<li>ERROR: UNABLE TO FIND BOND PARAMETERS FOR CT1 ON2 (ATOMS 2628 2626)<ul>
<li>Solution: The revalent solution has been mentioned above.</li>
</ul>
</li>
</ul>
<h3 id="zju-iqb-28-cluster">ZJU-iqb-28 cluster<a class="headerlink" href="#zju-iqb-28-cluster" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>username:shizq
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>password:***********
</span></code></pre></div>
<h2 id="result-visualization-and-rmsd-caculation">Result Visualization and RMSD Caculation<a class="headerlink" href="#result-visualization-and-rmsd-caculation" title="Permanent link">&para;</a></h2>
<h3 id="pymol-visulization">Pymol Visulization<a class="headerlink" href="#pymol-visulization" title="Permanent link">&para;</a></h3>
<p>To display the result more visually, we can use pymol to show the dymanic process of MD results. First, we should import .pdb file to Pymol, and then import the corresponding .dcd file. And now, we can see the dymanic process and further to generate a short animation. But the system still has ions and water, we can use the following command to remove ions and water:
<div class="language-py highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1">#select ions and create object</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">select</span> <span class="n">ions</span><span class="p">,</span> <span class="nb">all</span> <span class="ow">and</span> <span class="p">((</span><span class="n">resn</span> <span class="n">SOD</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">resn</span> <span class="n">CLA</span><span class="p">))</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1">#remove and delele object</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">remove</span> <span class="n">ion</span><span class="p">;</span> <span class="n">delete</span> <span class="n">ions</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1">#delete water</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">remove</span> <span class="n">solvent</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c1">#one command contains all operation</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="n">select</span> <span class="n">ions</span><span class="p">,</span> <span class="nb">all</span> <span class="ow">and</span> <span class="p">((</span><span class="n">resn</span> <span class="n">SOD</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">resn</span> <span class="n">CLA</span><span class="p">));</span> <span class="n">remove</span> <span class="n">ions</span><span class="p">;</span> <span class="n">delete</span> <span class="n">ions</span><span class="p">;</span> <span class="n">remove</span> <span class="n">solvent</span>
</span></code></pre></div>
After this operation, the system only remains protein and ligands.</p>
<h3 id="rmsd-caculation">RMSD caculation<a class="headerlink" href="#rmsd-caculation" title="Permanent link">&para;</a></h3>
<p>We can caculation RMSD using the VMD script(<em>vis_traj.tcl</em>), attention,in the usual case, replace the 'THZ1' to 'LIG'.
<div class="language-Tcl highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c"># vmd</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c"># source ../../vis_traj.tcl </span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c"># under prod</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c"># load psf and dcd file</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="nv">mol</span><span class="w"> </span>new<span class="w"> </span>system.psf<span class="w"> </span>type<span class="w"> </span>psf
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="c"># mol addfile rdrp-remtp-equil.dcd type dcd waitfor all</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="nv">mol</span><span class="w"> </span>addfile<span class="w"> </span>pro-lig-equil.dcd<span class="w"> </span>type<span class="w"> </span>dcd<span class="w"> </span>waitfor<span class="w"> </span>all
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="nv">display</span><span class="w"> </span>projection<span class="w">   </span>Orthographic
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="c"># display axes off</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="nv">color</span><span class="w"> </span>Display<span class="w"> </span><span class="k">{</span><span class="nv">Background</span><span class="k">}</span><span class="w"> </span>white
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="nv">label</span><span class="w"> </span>textthickness<span class="w"> </span><span class="mf">2.5</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="k">set</span><span class="w"> </span>numframes<span class="w"> </span><span class="k">[</span><span class="nv">molinfo</span><span class="w"> </span>top<span class="w"> </span>get<span class="w"> </span>numframes<span class="k">]</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="c"># set sel [atomselect top &quot;not water and not resname SOD and not resname CLA&quot;]</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="c"># $sel writepdb rdrp-remtp-preequil.pdb</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="c"># make representation</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="nv">mol</span><span class="w"> </span>delrep<span class="w"> </span><span class="mi">0</span><span class="w"> </span>top
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="nv">mol</span><span class="w"> </span>representation<span class="w"> </span>NewCartoon<span class="w"> </span><span class="mf">0.300000</span><span class="w"> </span><span class="mf">10.000000</span><span class="w"> </span><span class="mf">4.100000</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="c"># mol color Structure</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="c"># mol color Beta</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="c"># mol material AOShiny</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="nv">mol</span><span class="w"> </span>color<span class="w"> </span>ColorID<span class="w"> </span><span class="mi">8</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="nv">mol</span><span class="w"> </span>material<span class="w"> </span>Transparent
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="nv">mol</span><span class="w"> </span>selection<span class="w"> </span><span class="k">{</span><span class="nv">protein</span><span class="w"> </span>or<span class="w"> </span>nucleic<span class="w"> </span>and<span class="w"> </span>not<span class="w"> </span><span class="k">(</span><span class="nv">segname</span><span class="w"> </span>RN1<span class="w"> </span>and<span class="w"> </span>resid<span class="w"> </span><span class="mi">20</span><span class="k">)</span><span class="w"> </span>and<span class="w"> </span>not<span class="w"> </span><span class="k">(</span><span class="nv">segname</span><span class="w"> </span>RN2<span class="w"> </span>and<span class="w"> </span><span class="k">(</span><span class="nv">resid</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span>or<span class="w"> </span>resid<span class="w"> </span><span class="mi">11</span><span class="k">))}</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="c"># mol material Transparent</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="nv">mol</span><span class="w"> </span>addrep<span class="w"> </span>top
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="c"># add rep after setting up</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="nv">mol</span><span class="w"> </span>representation<span class="w"> </span>Licorice<span class="w"> </span><span class="mf">0.300000</span><span class="w"> </span><span class="mf">12.000000</span><span class="w"> </span><span class="mf">12.000000</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="nv">mol</span><span class="w"> </span>color<span class="w"> </span>Type
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="nv">mol</span><span class="w"> </span>selection<span class="w"> </span><span class="k">{</span><span class="nv">resname</span><span class="w"> </span>THZ1<span class="k">}</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="nv">mol</span><span class="w"> </span>material<span class="w"> </span>Opaque
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="nv">mol</span><span class="w"> </span>addrep<span class="w"> </span>top
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="nv">mol</span><span class="w"> </span>representation<span class="w"> </span>Licorice<span class="w"> </span><span class="mf">0.300000</span><span class="w"> </span><span class="mf">12.000000</span><span class="w"> </span><span class="mf">12.000000</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="nv">mol</span><span class="w"> </span>color<span class="w"> </span>Type
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a><span class="nv">mol</span><span class="w"> </span>selection<span class="w"> </span><span class="k">{(</span><span class="nv">segname</span><span class="w"> </span>RN1<span class="w"> </span>and<span class="w"> </span>resid<span class="w"> </span><span class="mi">20</span><span class="k">)</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="k">(</span><span class="nv">segname</span><span class="w"> </span>RN2<span class="w"> </span>and<span class="w"> </span><span class="k">(</span><span class="nv">resid</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span>or<span class="w"> </span>resid<span class="w"> </span><span class="mi">11</span><span class="k">))}</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a><span class="nv">mol</span><span class="w"> </span>material<span class="w"> </span>Opaque
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a><span class="nv">mol</span><span class="w"> </span>addrep<span class="w"> </span>top
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a><span class="nv">mol</span><span class="w"> </span>representation<span class="w"> </span>VDW<span class="w"> </span><span class="mf">1.000000</span><span class="w"> </span><span class="mf">12.000000</span>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a><span class="nv">mol</span><span class="w"> </span>color<span class="w"> </span>Type
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a><span class="nv">mol</span><span class="w"> </span>selection<span class="w"> </span><span class="k">{</span><span class="nv">resname</span><span class="w"> </span>MG<span class="w"> </span>or<span class="w"> </span>segname<span class="w"> </span>ZN<span class="k">}</span>
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a><span class="nv">mol</span><span class="w"> </span>material<span class="w"> </span>Opaque
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a><span class="nv">mol</span><span class="w"> </span>addrep<span class="w"> </span>top
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a><span class="nv">mol</span><span class="w"> </span>representation<span class="w"> </span>CPK<span class="w"> </span><span class="mf">0.200000</span>
</span><span id="__span-14-50"><a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a><span class="nv">mol</span><span class="w"> </span>color<span class="w"> </span>Type
</span><span id="__span-14-51"><a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a><span class="nv">mol</span><span class="w"> </span>selection<span class="w"> </span><span class="k">{</span><span class="nv">protein</span><span class="w"> </span>and<span class="w"> </span>noh<span class="w"> </span>and<span class="w"> </span><span class="k">(</span><span class="nv">same</span><span class="w"> </span>residue<span class="w"> </span>as<span class="w"> </span>within<span class="w"> </span><span class="mi">5</span><span class="w"> </span>of<span class="w"> </span>residue<span class="w"> </span>THZ1<span class="k">)</span><span class="w"> </span>or<span class="w"> </span><span class="k">(</span><span class="nv">same</span><span class="w"> </span>residue<span class="w"> </span>as<span class="w"> </span>within<span class="w"> </span><span class="mi">5</span><span class="w"> </span>of<span class="w"> </span>segname<span class="w"> </span>MG<span class="k">)}</span>
</span><span id="__span-14-52"><a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a><span class="nv">mol</span><span class="w"> </span>material<span class="w"> </span>Opaque
</span><span id="__span-14-53"><a id="__codelineno-14-53" name="__codelineno-14-53" href="#__codelineno-14-53"></a><span class="nv">mol</span><span class="w"> </span>addrep<span class="w"> </span>top
</span><span id="__span-14-54"><a id="__codelineno-14-54" name="__codelineno-14-54" href="#__codelineno-14-54"></a><span class="c"># update selection every frame</span>
</span><span id="__span-14-55"><a id="__codelineno-14-55" name="__codelineno-14-55" href="#__codelineno-14-55"></a><span class="nv">mol</span><span class="w"> </span>selupdate<span class="w"> </span><span class="mi">3</span><span class="w"> </span>top<span class="w"> </span><span class="mi">1</span>
</span><span id="__span-14-56"><a id="__codelineno-14-56" name="__codelineno-14-56" href="#__codelineno-14-56"></a><span class="nv">mol</span><span class="w"> </span>colupdate<span class="w"> </span><span class="mi">3</span><span class="w"> </span>top<span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-57"><a id="__codelineno-14-57" name="__codelineno-14-57" href="#__codelineno-14-57"></a>
</span><span id="__span-14-58"><a id="__codelineno-14-58" name="__codelineno-14-58" href="#__codelineno-14-58"></a><span class="nv">mol</span><span class="w"> </span>representation<span class="w"> </span>CPK<span class="w"> </span><span class="mf">0.200000</span>
</span><span id="__span-14-59"><a id="__codelineno-14-59" name="__codelineno-14-59" href="#__codelineno-14-59"></a><span class="nv">mol</span><span class="w"> </span>color<span class="w"> </span>Type
</span><span id="__span-14-60"><a id="__codelineno-14-60" name="__codelineno-14-60" href="#__codelineno-14-60"></a><span class="nv">mol</span><span class="w"> </span>selection<span class="w"> </span><span class="k">{</span><span class="nv">protein</span><span class="w"> </span>and<span class="w"> </span>noh<span class="w"> </span>and<span class="w"> </span><span class="k">(</span><span class="nv">same</span><span class="w"> </span>residue<span class="w"> </span>as<span class="w"> </span>within<span class="w"> </span><span class="mi">5</span><span class="w"> </span>of<span class="w"> </span>segname<span class="w"> </span>ZN<span class="k">)}</span>
</span><span id="__span-14-61"><a id="__codelineno-14-61" name="__codelineno-14-61" href="#__codelineno-14-61"></a><span class="nv">mol</span><span class="w"> </span>material<span class="w"> </span>Opaque
</span><span id="__span-14-62"><a id="__codelineno-14-62" name="__codelineno-14-62" href="#__codelineno-14-62"></a><span class="nv">mol</span><span class="w"> </span>addrep<span class="w"> </span>top
</span><span id="__span-14-63"><a id="__codelineno-14-63" name="__codelineno-14-63" href="#__codelineno-14-63"></a><span class="c"># update selection every frame</span>
</span><span id="__span-14-64"><a id="__codelineno-14-64" name="__codelineno-14-64" href="#__codelineno-14-64"></a><span class="nv">mol</span><span class="w"> </span>selupdate<span class="w"> </span><span class="mi">4</span><span class="w"> </span>top<span class="w"> </span><span class="mi">1</span>
</span><span id="__span-14-65"><a id="__codelineno-14-65" name="__codelineno-14-65" href="#__codelineno-14-65"></a><span class="nv">mol</span><span class="w"> </span>colupdate<span class="w"> </span><span class="mi">4</span><span class="w"> </span>top<span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-66"><a id="__codelineno-14-66" name="__codelineno-14-66" href="#__codelineno-14-66"></a>
</span><span id="__span-14-67"><a id="__codelineno-14-67" name="__codelineno-14-67" href="#__codelineno-14-67"></a><span class="c"># mol representation Surf 1.400000 0.000000</span>
</span><span id="__span-14-68"><a id="__codelineno-14-68" name="__codelineno-14-68" href="#__codelineno-14-68"></a><span class="c"># mol color Type</span>
</span><span id="__span-14-69"><a id="__codelineno-14-69" name="__codelineno-14-69" href="#__codelineno-14-69"></a><span class="c"># mol selection {protein and noh and (same residue as within 6 of residue LIG)}</span>
</span><span id="__span-14-70"><a id="__codelineno-14-70" name="__codelineno-14-70" href="#__codelineno-14-70"></a><span class="c"># mol material Opaque</span>
</span><span id="__span-14-71"><a id="__codelineno-14-71" name="__codelineno-14-71" href="#__codelineno-14-71"></a><span class="c"># mol addrep top</span>
</span><span id="__span-14-72"><a id="__codelineno-14-72" name="__codelineno-14-72" href="#__codelineno-14-72"></a>
</span><span id="__span-14-73"><a id="__codelineno-14-73" name="__codelineno-14-73" href="#__codelineno-14-73"></a><span class="c"># mol representation Licorice 0.300000 12.000000 12.000000</span>
</span><span id="__span-14-74"><a id="__codelineno-14-74" name="__codelineno-14-74" href="#__codelineno-14-74"></a><span class="c"># mol color Type</span>
</span><span id="__span-14-75"><a id="__codelineno-14-75" name="__codelineno-14-75" href="#__codelineno-14-75"></a><span class="c"># mol selection {nucleic}</span>
</span><span id="__span-14-76"><a id="__codelineno-14-76" name="__codelineno-14-76" href="#__codelineno-14-76"></a><span class="c"># mol material Opaque</span>
</span><span id="__span-14-77"><a id="__codelineno-14-77" name="__codelineno-14-77" href="#__codelineno-14-77"></a><span class="c"># mol addrep top</span>
</span><span id="__span-14-78"><a id="__codelineno-14-78" name="__codelineno-14-78" href="#__codelineno-14-78"></a>
</span><span id="__span-14-79"><a id="__codelineno-14-79" name="__codelineno-14-79" href="#__codelineno-14-79"></a><span class="c"># mol representation 1.000000</span>
</span><span id="__span-14-80"><a id="__codelineno-14-80" name="__codelineno-14-80" href="#__codelineno-14-80"></a><span class="c"># mol color Type</span>
</span><span id="__span-14-81"><a id="__codelineno-14-81" name="__codelineno-14-81" href="#__codelineno-14-81"></a><span class="c"># mol selection {water}</span>
</span><span id="__span-14-82"><a id="__codelineno-14-82" name="__codelineno-14-82" href="#__codelineno-14-82"></a><span class="c"># mol material Opaque</span>
</span><span id="__span-14-83"><a id="__codelineno-14-83" name="__codelineno-14-83" href="#__codelineno-14-83"></a><span class="c"># mol addrep top</span>
</span><span id="__span-14-84"><a id="__codelineno-14-84" name="__codelineno-14-84" href="#__codelineno-14-84"></a>
</span><span id="__span-14-85"><a id="__codelineno-14-85" name="__codelineno-14-85" href="#__codelineno-14-85"></a><span class="c"># fragment: time-consuming!</span>
</span><span id="__span-14-86"><a id="__codelineno-14-86" name="__codelineno-14-86" href="#__codelineno-14-86"></a><span class="c"># pbc wrap -centersel &quot;protein or nucleic or resname LIG or segname MG or segname ZN&quot; -compound segid -center com -all</span>
</span><span id="__span-14-87"><a id="__codelineno-14-87" name="__codelineno-14-87" href="#__codelineno-14-87"></a><span class="c"># pbc wrap -centersel &quot;protein or nucleic or resname LIG or segname MG or segname ZN&quot; -compound chain -center com -all</span>
</span><span id="__span-14-88"><a id="__codelineno-14-88" name="__codelineno-14-88" href="#__codelineno-14-88"></a><span class="c"># pbc join res -ref &quot;name CA&quot;</span>
</span><span id="__span-14-89"><a id="__codelineno-14-89" name="__codelineno-14-89" href="#__codelineno-14-89"></a>
</span><span id="__span-14-90"><a id="__codelineno-14-90" name="__codelineno-14-90" href="#__codelineno-14-90"></a><span class="c"># align the protein</span>
</span><span id="__span-14-91"><a id="__codelineno-14-91" name="__codelineno-14-91" href="#__codelineno-14-91"></a><span class="nb">package</span><span class="w"> </span>require<span class="w"> </span>rmsdtt
</span><span id="__span-14-92"><a id="__codelineno-14-92" name="__codelineno-14-92" href="#__codelineno-14-92"></a><span class="c"># open the window</span>
</span><span id="__span-14-93"><a id="__codelineno-14-93" name="__codelineno-14-93" href="#__codelineno-14-93"></a><span class="k">set</span><span class="w"> </span>w<span class="w"> </span><span class="k">[</span><span class="nv">rmsdtt_tk_cb</span><span class="k">]</span>
</span><span id="__span-14-94"><a id="__codelineno-14-94" name="__codelineno-14-94" href="#__codelineno-14-94"></a><span class="nv">$w.top.left.sel</span><span class="w"> </span><span class="nv">delete</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span>end
</span><span id="__span-14-95"><a id="__codelineno-14-95" name="__codelineno-14-95" href="#__codelineno-14-95"></a><span class="nv">$w.top.left.sel</span><span class="w"> </span><span class="nv">insert</span><span class="w"> </span>end<span class="w"> </span><span class="s2">&quot;protein&quot;</span>
</span><span id="__span-14-96"><a id="__codelineno-14-96" name="__codelineno-14-96" href="#__codelineno-14-96"></a><span class="c"># set the states of checkboxes1</span>
</span><span id="__span-14-97"><a id="__codelineno-14-97" name="__codelineno-14-97" href="#__codelineno-14-97"></a><span class="k">set</span><span class="w"> </span>rmsdtt::trace_only<span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-98"><a id="__codelineno-14-98" name="__codelineno-14-98" href="#__codelineno-14-98"></a><span class="k">set</span><span class="w"> </span>rmsdtt::noh<span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-99"><a id="__codelineno-14-99" name="__codelineno-14-99" href="#__codelineno-14-99"></a><span class="k">set</span><span class="w"> </span>rmsdtt::bb_only<span class="w"> </span><span class="mi">1</span>
</span><span id="__span-14-100"><a id="__codelineno-14-100" name="__codelineno-14-100" href="#__codelineno-14-100"></a><span class="c"># rmsdtt::set_sel  # verify selection</span>
</span><span id="__span-14-101"><a id="__codelineno-14-101" name="__codelineno-14-101" href="#__codelineno-14-101"></a><span class="nv">rmsdtt</span><span class="o">::</span>doAlign
</span><span id="__span-14-102"><a id="__codelineno-14-102" name="__codelineno-14-102" href="#__codelineno-14-102"></a>
</span><span id="__span-14-103"><a id="__codelineno-14-103" name="__codelineno-14-103" href="#__codelineno-14-103"></a><span class="c"># change selection text</span>
</span><span id="__span-14-104"><a id="__codelineno-14-104" name="__codelineno-14-104" href="#__codelineno-14-104"></a><span class="nv">$w.top.left.sel</span><span class="w"> </span><span class="nv">delete</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span>end
</span><span id="__span-14-105"><a id="__codelineno-14-105" name="__codelineno-14-105" href="#__codelineno-14-105"></a><span class="nv">$w.top.left.sel</span><span class="w"> </span><span class="nv">insert</span><span class="w"> </span>end<span class="w"> </span><span class="s2">&quot;resname THZ1&quot;</span>
</span><span id="__span-14-106"><a id="__codelineno-14-106" name="__codelineno-14-106" href="#__codelineno-14-106"></a><span class="k">set</span><span class="w"> </span>rmsdtt::bb_only<span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-107"><a id="__codelineno-14-107" name="__codelineno-14-107" href="#__codelineno-14-107"></a><span class="c"># set rmsdtt::xmgrace 1</span>
</span><span id="__span-14-108"><a id="__codelineno-14-108" name="__codelineno-14-108" href="#__codelineno-14-108"></a><span class="c"># set rmsdtt::multiplot 0</span>
</span><span id="__span-14-109"><a id="__codelineno-14-109" name="__codelineno-14-109" href="#__codelineno-14-109"></a><span class="k">set</span><span class="w"> </span>rmsdtt::plot_sw<span class="w"> </span><span class="mi">1</span>
</span><span id="__span-14-110"><a id="__codelineno-14-110" name="__codelineno-14-110" href="#__codelineno-14-110"></a><span class="k">set</span><span class="w"> </span>rmsdtt::save_sw<span class="w"> </span><span class="mi">1</span>
</span><span id="__span-14-111"><a id="__codelineno-14-111" name="__codelineno-14-111" href="#__codelineno-14-111"></a><span class="k">set</span><span class="w"> </span>rmsdtt::save_file<span class="w"> </span>sys-rmsd.dat
</span><span id="__span-14-112"><a id="__codelineno-14-112" name="__codelineno-14-112" href="#__codelineno-14-112"></a><span class="nv">rmsdtt</span><span class="o">::</span>doRmsd
</span><span id="__span-14-113"><a id="__codelineno-14-113" name="__codelineno-14-113" href="#__codelineno-14-113"></a>
</span><span id="__span-14-114"><a id="__codelineno-14-114" name="__codelineno-14-114" href="#__codelineno-14-114"></a><span class="k">set</span><span class="w"> </span>numframes<span class="w"> </span><span class="k">[</span><span class="nv">molinfo</span><span class="w"> </span>top<span class="w"> </span>get<span class="w"> </span>numframes<span class="k">]</span>
</span><span id="__span-14-115"><a id="__codelineno-14-115" name="__codelineno-14-115" href="#__codelineno-14-115"></a><span class="c"># move to center. maybe execute again after aligning the protein...</span>
</span><span id="__span-14-116"><a id="__codelineno-14-116" name="__codelineno-14-116" href="#__codelineno-14-116"></a><span class="k">set</span><span class="w"> </span>lig<span class="w"> </span><span class="k">[</span><span class="nv">atomselect</span><span class="w"> </span>top<span class="w"> </span><span class="s2">&quot;segname RN1 and resid 20 or segname RN2 and (resid 11 or resid 10) or resname THZ1&quot;</span><span class="w"> </span>frame<span class="w"> </span><span class="k">[expr</span><span class="w"> </span><span class="nv">$numframes-1</span><span class="k">]]</span>
</span><span id="__span-14-117"><a id="__codelineno-14-117" name="__codelineno-14-117" href="#__codelineno-14-117"></a><span class="c"># set lig [atomselect top &quot;segname RN1 and resid 20 or segname RN2 and (resid 11or resid 10) or resname THZ1&quot; frame 0]</span>
</span><span id="__span-14-118"><a id="__codelineno-14-118" name="__codelineno-14-118" href="#__codelineno-14-118"></a><span class="k">set</span><span class="w"> </span>cen<span class="w"> </span><span class="k">[</span><span class="nv">measure</span><span class="w"> </span>center<span class="w"> </span><span class="nv">$lig</span><span class="w"> </span>weight<span class="w"> </span>mass<span class="k">]</span>
</span><span id="__span-14-119"><a id="__codelineno-14-119" name="__codelineno-14-119" href="#__codelineno-14-119"></a><span class="k">foreach</span><span class="w"> </span><span class="k">{</span><span class="nv">x</span><span class="w"> </span>y<span class="w"> </span>z<span class="k">}</span><span class="w"> </span><span class="nv">$cen</span><span class="w"> </span><span class="k">{</span><span class="w"> </span><span class="k">break</span><span class="w"> </span><span class="k">}</span>
</span><span id="__span-14-120"><a id="__codelineno-14-120" name="__codelineno-14-120" href="#__codelineno-14-120"></a><span class="nv">molinfo</span><span class="w"> </span>top<span class="w"> </span>set<span class="w"> </span>center_matrix<span class="w"> </span><span class="s2">&quot;{{1 0 0 [expr -$x]} {0 1 0 [expr -$y]} {0 0 1 [expr -$z]} {0 0 0 1}}&quot;</span>
</span><span id="__span-14-121"><a id="__codelineno-14-121" name="__codelineno-14-121" href="#__codelineno-14-121"></a><span class="c"># use negative...</span>
</span><span id="__span-14-122"><a id="__codelineno-14-122" name="__codelineno-14-122" href="#__codelineno-14-122"></a>
</span><span id="__span-14-123"><a id="__codelineno-14-123" name="__codelineno-14-123" href="#__codelineno-14-123"></a><span class="c"># animate write dcd rdrp-remtp-prod-firstpart.dcd beg 0 end 350</span>
</span><span id="__span-14-124"><a id="__codelineno-14-124" name="__codelineno-14-124" href="#__codelineno-14-124"></a>
</span><span id="__span-14-125"><a id="__codelineno-14-125" name="__codelineno-14-125" href="#__codelineno-14-125"></a><span class="c"># set sel [atomselect top all frame [expr $numframes - 1]]</span>
</span><span id="__span-14-126"><a id="__codelineno-14-126" name="__codelineno-14-126" href="#__codelineno-14-126"></a><span class="c"># $sel writepdb last.pdb</span>
</span><span id="__span-14-127"><a id="__codelineno-14-127" name="__codelineno-14-127" href="#__codelineno-14-127"></a>
</span><span id="__span-14-128"><a id="__codelineno-14-128" name="__codelineno-14-128" href="#__codelineno-14-128"></a><span class="c"># set cartoon_transparency, 0.6</span>
</span><span id="__span-14-129"><a id="__codelineno-14-129" name="__codelineno-14-129" href="#__codelineno-14-129"></a><span class="c"># bg_color white</span>
</span><span id="__span-14-130"><a id="__codelineno-14-130" name="__codelineno-14-130" href="#__codelineno-14-130"></a>
</span><span id="__span-14-131"><a id="__codelineno-14-131" name="__codelineno-14-131" href="#__codelineno-14-131"></a><span class="c"># output for vmd</span>
</span><span id="__span-14-132"><a id="__codelineno-14-132" name="__codelineno-14-132" href="#__codelineno-14-132"></a><span class="c"># set sele &quot;segname PR1 and (&quot;</span>
</span><span id="__span-14-133"><a id="__codelineno-14-133" name="__codelineno-14-133" href="#__codelineno-14-133"></a><span class="c"># set sel [atomselect top &quot;protein and name CA and (same residue as within 10 of (resname THZ1))&quot;]</span>
</span><span id="__span-14-134"><a id="__codelineno-14-134" name="__codelineno-14-134" href="#__codelineno-14-134"></a><span class="c"># foreach resid [$sel get resid] {</span>
</span><span id="__span-14-135"><a id="__codelineno-14-135" name="__codelineno-14-135" href="#__codelineno-14-135"></a><span class="c">#     append sele  &quot;residue $resid or &quot;</span>
</span><span id="__span-14-136"><a id="__codelineno-14-136" name="__codelineno-14-136" href="#__codelineno-14-136"></a><span class="c"># }</span>
</span><span id="__span-14-137"><a id="__codelineno-14-137" name="__codelineno-14-137" href="#__codelineno-14-137"></a><span class="c"># puts $sele</span>
</span><span id="__span-14-138"><a id="__codelineno-14-138" name="__codelineno-14-138" href="#__codelineno-14-138"></a>
</span><span id="__span-14-139"><a id="__codelineno-14-139" name="__codelineno-14-139" href="#__codelineno-14-139"></a><span class="c"># output for gmx</span>
</span><span id="__span-14-140"><a id="__codelineno-14-140" name="__codelineno-14-140" href="#__codelineno-14-140"></a><span class="k">set</span><span class="w"> </span>sele<span class="w"> </span><span class="s2">&quot;r&quot;</span>
</span><span id="__span-14-141"><a id="__codelineno-14-141" name="__codelineno-14-141" href="#__codelineno-14-141"></a><span class="k">set</span><span class="w"> </span>sel<span class="w"> </span><span class="k">[</span><span class="nv">atomselect</span><span class="w"> </span>top<span class="w"> </span><span class="s2">&quot;protein and name CA and (same residue as within 10 of (resname THZ1))&quot;</span><span class="k">]</span>
</span><span id="__span-14-142"><a id="__codelineno-14-142" name="__codelineno-14-142" href="#__codelineno-14-142"></a><span class="k">foreach</span><span class="w"> </span>resid<span class="w"> </span><span class="k">[</span><span class="nv">$sel</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span>resid<span class="k">]</span><span class="w"> </span><span class="k">{</span>
</span><span id="__span-14-143"><a id="__codelineno-14-143" name="__codelineno-14-143" href="#__codelineno-14-143"></a><span class="w">    </span><span class="nb">append</span><span class="w"> </span>sele<span class="w">  </span><span class="s2">&quot;$resid or &quot;</span>
</span><span id="__span-14-144"><a id="__codelineno-14-144" name="__codelineno-14-144" href="#__codelineno-14-144"></a><span class="k">}</span>
</span><span id="__span-14-145"><a id="__codelineno-14-145" name="__codelineno-14-145" href="#__codelineno-14-145"></a><span class="nb">puts</span><span class="w"> </span><span class="nv">$sele</span>
</span><span id="__span-14-146"><a id="__codelineno-14-146" name="__codelineno-14-146" href="#__codelineno-14-146"></a>
</span><span id="__span-14-147"><a id="__codelineno-14-147" name="__codelineno-14-147" href="#__codelineno-14-147"></a><span class="c"># # http://github.com/anjibabuIITK/CLUSTER-ANALYSIS-USING-VMD-TCL</span>
</span><span id="__span-14-148"><a id="__codelineno-14-148" name="__codelineno-14-148" href="#__codelineno-14-148"></a><span class="k">set</span><span class="w"> </span>number<span class="w"> </span><span class="mi">9</span>
</span><span id="__span-14-149"><a id="__codelineno-14-149" name="__codelineno-14-149" href="#__codelineno-14-149"></a><span class="k">set</span><span class="w"> </span>rcutoff<span class="w"> </span><span class="mi">1</span>
</span><span id="__span-14-150"><a id="__codelineno-14-150" name="__codelineno-14-150" href="#__codelineno-14-150"></a><span class="k">set</span><span class="w"> </span>step_size<span class="w"> </span><span class="mi">1</span>
</span><span id="__span-14-151"><a id="__codelineno-14-151" name="__codelineno-14-151" href="#__codelineno-14-151"></a><span class="k">set</span><span class="w"> </span>nframes<span class="w"> </span><span class="k">[</span><span class="nv">molinfo</span><span class="w"> </span>top<span class="w"> </span>get<span class="w"> </span>numframes<span class="k">]</span>
</span><span id="__span-14-152"><a id="__codelineno-14-152" name="__codelineno-14-152" href="#__codelineno-14-152"></a><span class="k">set</span><span class="w"> </span>inf<span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-153"><a id="__codelineno-14-153" name="__codelineno-14-153" href="#__codelineno-14-153"></a><span class="k">set</span><span class="w"> </span>nf<span class="w"> </span><span class="nv">$nframes</span>
</span><span id="__span-14-154"><a id="__codelineno-14-154" name="__codelineno-14-154" href="#__codelineno-14-154"></a><span class="k">set</span><span class="w"> </span>totframes<span class="w"> </span><span class="k">[expr</span><span class="w"> </span><span class="nv">$nf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">]</span>
</span><span id="__span-14-155"><a id="__codelineno-14-155" name="__codelineno-14-155" href="#__codelineno-14-155"></a><span class="k">set</span><span class="w"> </span>selA<span class="w"> </span><span class="k">[</span><span class="nv">atomselect</span><span class="w"> </span>top<span class="w"> </span><span class="s2">&quot;resname THZ1&quot;</span><span class="k">]</span>
</span><span id="__span-14-156"><a id="__codelineno-14-156" name="__codelineno-14-156" href="#__codelineno-14-156"></a><span class="k">set</span><span class="w"> </span>lists<span class="w"> </span><span class="k">[</span><span class="nv">measure</span><span class="w"> </span>cluster<span class="w"> </span><span class="nv">$selA</span><span class="w"> </span>num<span class="w"> </span><span class="nv">$number</span><span class="w"> </span>cutoff<span class="w"> </span><span class="nv">$rcutoff</span><span class="w"> </span>first<span class="w"> </span><span class="nv">$inf</span><span class="w"> </span>last<span class="w"> </span><span class="nv">$totframes</span><span class="w"> </span>step<span class="w"> </span><span class="nv">$step_size</span><span class="w"> </span>distfunc<span class="w"> </span>rmsd<span class="w"> </span>weight<span class="w"> </span>mass<span class="k">]</span>
</span><span id="__span-14-157"><a id="__codelineno-14-157" name="__codelineno-14-157" href="#__codelineno-14-157"></a>
</span><span id="__span-14-158"><a id="__codelineno-14-158" name="__codelineno-14-158" href="#__codelineno-14-158"></a><span class="k">set</span><span class="w"> </span>file<span class="w"> </span><span class="k">[</span><span class="nb">open</span><span class="w"> </span><span class="s2">&quot;clus_result.dat&quot;</span><span class="w"> </span>w<span class="k">]</span>
</span><span id="__span-14-159"><a id="__codelineno-14-159" name="__codelineno-14-159" href="#__codelineno-14-159"></a><span class="k">for</span><span class="w"> </span><span class="k">{set</span><span class="w"> </span>i<span class="w"> </span><span class="mi">1</span><span class="k">}</span><span class="w"> </span><span class="k">{</span><span class="nv">$i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="k">[</span><span class="nb">llength</span><span class="w"> </span><span class="nv">$lists</span><span class="k">]}</span><span class="w"> </span><span class="k">{</span><span class="nb">incr</span><span class="w"> </span>i<span class="k">}</span><span class="w"> </span><span class="k">{</span>
</span><span id="__span-14-160"><a id="__codelineno-14-160" name="__codelineno-14-160" href="#__codelineno-14-160"></a><span class="w">    </span><span class="k">set</span><span class="w"> </span>lst<span class="w"> </span><span class="k">[</span><span class="nb">lindex</span><span class="w"> </span><span class="nv">$lists</span><span class="w"> </span><span class="k">[expr</span><span class="w"> </span><span class="nv">$i-1</span><span class="k">]]</span>
</span><span id="__span-14-161"><a id="__codelineno-14-161" name="__codelineno-14-161" href="#__codelineno-14-161"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="nv">$file</span><span class="w"> </span><span class="k">[</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;cluster %d: %d&quot;</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="k">[</span><span class="nb">llength</span><span class="w"> </span><span class="nv">$lst</span><span class="k">]]</span>
</span><span id="__span-14-162"><a id="__codelineno-14-162" name="__codelineno-14-162" href="#__codelineno-14-162"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="nv">$file</span><span class="w"> </span><span class="nv">$lst</span>
</span><span id="__span-14-163"><a id="__codelineno-14-163" name="__codelineno-14-163" href="#__codelineno-14-163"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="nv">$file</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
</span><span id="__span-14-164"><a id="__codelineno-14-164" name="__codelineno-14-164" href="#__codelineno-14-164"></a><span class="k">}</span>
</span><span id="__span-14-165"><a id="__codelineno-14-165" name="__codelineno-14-165" href="#__codelineno-14-165"></a><span class="nb">close</span><span class="w"> </span><span class="nv">$file</span>
</span><span id="__span-14-166"><a id="__codelineno-14-166" name="__codelineno-14-166" href="#__codelineno-14-166"></a>
</span><span id="__span-14-167"><a id="__codelineno-14-167" name="__codelineno-14-167" href="#__codelineno-14-167"></a><span class="k">set</span><span class="w"> </span>c01<span class="w"> </span><span class="k">[</span><span class="nb">lindex</span><span class="w"> </span><span class="k">[</span><span class="nb">lindex</span><span class="w"> </span><span class="nv">$lists</span><span class="w"> </span><span class="mi">0</span><span class="k">]</span><span class="w"> </span><span class="mi">0</span><span class="k">]</span>
</span><span id="__span-14-168"><a id="__codelineno-14-168" name="__codelineno-14-168" href="#__codelineno-14-168"></a><span class="k">set</span><span class="w"> </span>sel<span class="w"> </span><span class="k">[</span><span class="nv">atomselect</span><span class="w"> </span>top<span class="w"> </span>all<span class="w"> </span>frame<span class="w"> </span><span class="nv">$c01</span><span class="k">]</span>
</span><span id="__span-14-169"><a id="__codelineno-14-169" name="__codelineno-14-169" href="#__codelineno-14-169"></a><span class="k">set</span><span class="w"> </span>real_frame<span class="w"> </span><span class="k">[expr</span><span class="w"> </span><span class="nv">$c01</span><span class="o">+</span><span class="mi">1</span><span class="k">]</span>
</span><span id="__span-14-170"><a id="__codelineno-14-170" name="__codelineno-14-170" href="#__codelineno-14-170"></a><span class="nv">$sel</span><span class="w"> </span><span class="nv">writepdb</span><span class="w"> </span>c01_<span class="nv">${real_frame}</span>.pdb
</span><span id="__span-14-171"><a id="__codelineno-14-171" name="__codelineno-14-171" href="#__codelineno-14-171"></a><span class="nb">puts</span><span class="w"> </span><span class="k">[</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;write the centroid of 1st cluster: frame %d&quot;</span><span class="w"> </span><span class="nv">$real_frame</span><span class="k">]</span>
</span><span id="__span-14-172"><a id="__codelineno-14-172" name="__codelineno-14-172" href="#__codelineno-14-172"></a>
</span><span id="__span-14-173"><a id="__codelineno-14-173" name="__codelineno-14-173" href="#__codelineno-14-173"></a><span class="k">set</span><span class="w"> </span>c02<span class="w"> </span><span class="k">[</span><span class="nb">lindex</span><span class="w"> </span><span class="k">[</span><span class="nb">lindex</span><span class="w"> </span><span class="nv">$lists</span><span class="w"> </span><span class="mi">1</span><span class="k">]</span><span class="w"> </span><span class="mi">0</span><span class="k">]</span>
</span><span id="__span-14-174"><a id="__codelineno-14-174" name="__codelineno-14-174" href="#__codelineno-14-174"></a><span class="k">set</span><span class="w"> </span>sel<span class="w"> </span><span class="k">[</span><span class="nv">atomselect</span><span class="w"> </span>top<span class="w"> </span>all<span class="w"> </span>frame<span class="w"> </span><span class="nv">$c02</span><span class="k">]</span>
</span><span id="__span-14-175"><a id="__codelineno-14-175" name="__codelineno-14-175" href="#__codelineno-14-175"></a><span class="k">set</span><span class="w"> </span>real_frame<span class="w"> </span><span class="k">[expr</span><span class="w"> </span><span class="nv">$c02</span><span class="o">+</span><span class="mi">1</span><span class="k">]</span>
</span><span id="__span-14-176"><a id="__codelineno-14-176" name="__codelineno-14-176" href="#__codelineno-14-176"></a><span class="nv">$sel</span><span class="w"> </span><span class="nv">writepdb</span><span class="w"> </span>c02_<span class="nv">${real_frame}</span>.pdb
</span><span id="__span-14-177"><a id="__codelineno-14-177" name="__codelineno-14-177" href="#__codelineno-14-177"></a><span class="nb">puts</span><span class="w"> </span><span class="k">[</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;write the centroid of 2nd cluster: frame %d&quot;</span><span class="w"> </span><span class="nv">$real_frame</span><span class="k">]</span>
</span><span id="__span-14-178"><a id="__codelineno-14-178" name="__codelineno-14-178" href="#__codelineno-14-178"></a>
</span><span id="__span-14-179"><a id="__codelineno-14-179" name="__codelineno-14-179" href="#__codelineno-14-179"></a><span class="c"># package require rmsdtt</span>
</span><span id="__span-14-180"><a id="__codelineno-14-180" name="__codelineno-14-180" href="#__codelineno-14-180"></a><span class="c"># set w [rmsdtt_tk_cb]</span>
</span><span id="__span-14-181"><a id="__codelineno-14-181" name="__codelineno-14-181" href="#__codelineno-14-181"></a><span class="c"># $w.top.left.sel delete 1.0 end</span>
</span><span id="__span-14-182"><a id="__codelineno-14-182" name="__codelineno-14-182" href="#__codelineno-14-182"></a><span class="c"># $w.top.left.sel insert end &quot;chain A and (resid 545 or resid 547 or resid 553 or resid 555 or resid 556 or resid 557 or resid 558 or resid 618 or resid 619 or </span>
</span><span id="__span-14-183"><a id="__codelineno-14-183" name="__codelineno-14-183" href="#__codelineno-14-183"></a><span class="c"># resid 621 or resid 622 or resid 623 or resid 624 or resid 680 or resid 681 or resid 682 or resid 683 or resid 684 or resid 688 or resid 691 or resid 758 or resid 759 or </span>
</span><span id="__span-14-184"><a id="__codelineno-14-184" name="__codelineno-14-184" href="#__codelineno-14-184"></a><span class="c"># resid 760 or resid 761 or resid 798 or resid 811 or resid 812 or resid 813 or resid 814)&quot;</span>
</span><span id="__span-14-185"><a id="__codelineno-14-185" name="__codelineno-14-185" href="#__codelineno-14-185"></a><span class="c"># set rmsdtt::trace_only 0</span>
</span><span id="__span-14-186"><a id="__codelineno-14-186" name="__codelineno-14-186" href="#__codelineno-14-186"></a><span class="c"># set rmsdtt::noh 0</span>
</span><span id="__span-14-187"><a id="__codelineno-14-187" name="__codelineno-14-187" href="#__codelineno-14-187"></a><span class="c"># set rmsdtt::bb_only 1</span>
</span><span id="__span-14-188"><a id="__codelineno-14-188" name="__codelineno-14-188" href="#__codelineno-14-188"></a><span class="c"># rmsdtt::doAlign</span>
</span><span id="__span-14-189"><a id="__codelineno-14-189" name="__codelineno-14-189" href="#__codelineno-14-189"></a>
</span><span id="__span-14-190"><a id="__codelineno-14-190" name="__codelineno-14-190" href="#__codelineno-14-190"></a><span class="c"># package require vmdmovie</span>
</span><span id="__span-14-191"><a id="__codelineno-14-191" name="__codelineno-14-191" href="#__codelineno-14-191"></a><span class="c"># MovieMaker::moviemaker</span>
</span><span id="__span-14-192"><a id="__codelineno-14-192" name="__codelineno-14-192" href="#__codelineno-14-192"></a><span class="c"># # install netpbm</span>
</span><span id="__span-14-193"><a id="__codelineno-14-193" name="__codelineno-14-193" href="#__codelineno-14-193"></a><span class="c"># # set MovieMaker::presmooth 1</span>
</span><span id="__span-14-194"><a id="__codelineno-14-194" name="__codelineno-14-194" href="#__codelineno-14-194"></a><span class="c"># set MovieMaker::prescale 1</span>
</span><span id="__span-14-195"><a id="__codelineno-14-195" name="__codelineno-14-195" href="#__codelineno-14-195"></a><span class="c"># set MovieMaker::movieformat imgif</span>
</span><span id="__span-14-196"><a id="__codelineno-14-196" name="__codelineno-14-196" href="#__codelineno-14-196"></a><span class="c"># set MovieMaker::framerate 30</span>
</span><span id="__span-14-197"><a id="__codelineno-14-197" name="__codelineno-14-197" href="#__codelineno-14-197"></a><span class="c"># set MovieMaker::workdir ./</span>
</span><span id="__span-14-198"><a id="__codelineno-14-198" name="__codelineno-14-198" href="#__codelineno-14-198"></a><span class="c"># set MovieMaker::basename ${path}</span>
</span><span id="__span-14-199"><a id="__codelineno-14-199" name="__codelineno-14-199" href="#__codelineno-14-199"></a><span class="c"># set MovieMaker::trjstep 20</span>
</span><span id="__span-14-200"><a id="__codelineno-14-200" name="__codelineno-14-200" href="#__codelineno-14-200"></a><span class="c"># set MovieMaker::renderer libtachyon</span>
</span><span id="__span-14-201"><a id="__codelineno-14-201" name="__codelineno-14-201" href="#__codelineno-14-201"></a><span class="c"># set MovieMaker::movietype trajectory</span>
</span><span id="__span-14-202"><a id="__codelineno-14-202" name="__codelineno-14-202" href="#__codelineno-14-202"></a><span class="c"># # you should click on the trjstep. this window doesn&#39;t really recognize what we write there...</span>
</span><span id="__span-14-203"><a id="__codelineno-14-203" name="__codelineno-14-203" href="#__codelineno-14-203"></a><span class="c"># MovieMaker::buildmovie</span>
</span></code></pre></div></p>
<h2 id="references">References:<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<p>[1] psfgen User's Guide 
[2] VMD User's Guide</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 A.I.B.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/AIB001" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://X.com" target="_blank" rel="noopener" title="X.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/zhaoqi-shi-9800a6345/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.top", "navigation.path", "toc.integrate", "search.highlight", "search.suggest", "content.code.copy", "content.code.annotate", "header.autohide"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>